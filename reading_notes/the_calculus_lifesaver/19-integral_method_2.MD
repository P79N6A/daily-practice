# 积分的方法 II

## 一、应用三角恒等式的积分

#### ◉ 第一类恒等式
通过 ```cos(2x) = 2*cos^2(x) - 1``` 和 ```cos(2x) = 1 - 2 * cos^2(x)```，我们有：
```
cos^2(x) = 1/2 * (1 + cos(2x))
sin^2(x) = 1/2 * (1 - cos(2x))
```

#### ◉ 第二类，毕达哥拉斯恒等式
```
sin^2(x) + cos^2(x) = 1
tan^2(x) + 1 = sec^2(x)
1 + cot^2(x) = csc^2(x)

csc(x) = 1/sin(x)
sec(x) = 1/cos(x)
tan(x) = 1/cot(x) = sin(x)/cos(x) = sin(x)*sec(x)
cot(x) = 1/tan(x) = cos(x)/sin(x) = cos(x)*csc(x)
```

有时，在积分的分母中有 ```1 + trig(x)``` 或 ```1 - trig(x)```，其中 trig 是三角函数，那么可以考虑这个积分表达式乘以与其分母共轭的表达式。

#### ◉ 第三类，积化和差公式
```
cos(A)cos(B) = 1/2 * (cos(A - B) + cos(A + B))
sin(A)sin(B) = 1/2 * (cos(A - B) - cos(A + B))
sin(A)cos(B) = 1/2 * (sin(A - B) - sin(A + B))
```

## 二、关于三角函数的幂的积分

#### ◉ 1. sin 或 cos的幂
黄金法则：如果 sin(x) 或 cos(x) 其中一个的幂是奇数，那就一定要抓住它：
拿出其中一项同 dx 放在一起，再用下列公式中的一个来处理剩下的项：
```
cos^2(x) = 1 - sin^2(x)
sin^2(x) = 1 - cos^2(x)
```

如果 幂是偶数，那应该使用倍角公式：
```
cos^2(x) = 1/2 * (1 + cos(2x))
sin^2(x) = 1/2 * (1 - cos(2x))
```
#### ◉ 2. tan 的幂
对于 ∫ tan(x)dx，可令 ```t = cos(x), dt = -sin(x)dx```，得：
```
∫ tan(x)dx = ∫ sin(x)/cos(x) dx = -∫ dt/t = -ln|t|+C = -ln|cos(x)| + C
```
对于高次幂，使用毕达哥拉斯定理：
```
tan^2(x) = sec^2(x) - 1
```
例如：
```
∫ tan^4(x)dx = ∫ tan^2(x)* tan^2(x) dx = ∫ tan^2(x)* (sec^2(x)-1) dx
             = ∫ tan^2(x)* sec^2(x) dx - ∫ tan^2(x) dx
设 t = tan(x)，有 dt = sec^2(x)dx
             = ∫ t^2 dt - ∫ (sec^2(x)-1) dx
             = t^3/3 - (tan(x) - x) + C
```

#### ◉ 3. sec 的幂
1) 计算 ∫ sec(x)dx 有一个技巧，即：分子分母同时乘以 (sec(x)+tan(x))，例：
```
∫ sec(x)dx = ∫ sec(x) * (sec(x)+tan(x))/(sec(x)+tan(x))
           = ∫ (sec^2(x) + sec(x)*tan(x))/(sec(x)+tan(x))
因为分子 (sec^2(x) + sec(x)*tan(x)) 的导数恰恰等于分母，令 t = (sec(x)+tan(x))，有
           = ln |(sec(x)+tan(x))| + C
```
2) 计算高次幂：用分部积分法把 sec^x(x)提出来， 应用 ```dv=sec^2(x)dv,  v=tan(x)```，并把 u 设为余下的 sec(x) 次幂。

#### ◉ 4. cot 的幂
使用毕达哥拉斯定理：
```
cot^2(x) = csc^2(x) - 1
```

#### ◉ 5. csc 的幂
和计算 sec(x) 的幂一样：可以把 csc^2(x) 提出来，然后用分部积分法，应用 ```dv = csc^2(xdx), v = -cot(x)```。

#### ◉ 6. 约化公式
三角函数积分的 n次项称为 I(n)，它的递归表达式为：
```
I(n) = (n-1)/n I(n-2)
```

## 三、关于三角换元法的积分

#### ◉ 类型1：sqrt(a^2 - x^2)
遇到关于```sqrt(a^2 - x^2)```的奇次幂项，正确的替代方法是使用```x = a*sin(θ)```。

设对边为x，斜边为a，邻边为sqrt(a^2-x^2)。根据毕达哥拉斯定理，有：
```
sin(θ) = x / a
```
所以有：
```
a^2 - x^2 = a^2 - a^2 * sin^2(θ) = a^2 *(1 - sin^2(θ)) = a^2 * cos^2(θ)
```

#### ◉ 类型2：sqrt(a^2 + x^2)
遇到关于```sqrt(a^2 + x^2)```的奇次幂项，正确的替代方法是使用```x = a*tan(θ)```。

设对边为x，邻边为a，斜边为sqrt(a^2+x^2)。根据毕达哥拉斯定理，有：
```
x^2+a^2 = a^2 * tan^2(θ) = a^2*(tan^2(θ) + 1) = a^2 * sec^2(θ)
```

#### ◉ 类型3：sqrt(x^2 - a^2)
遇到关于```sqrt(x^2 - a^2)```的奇次幂项，正确的替代方法是使用```x = a*sec(θ)```。

设对边为sqrt(x^2 - a^2)，邻边为a，斜边为x。根据毕达哥拉斯定理，有：
```
x^2 - a^2 = a^2*sec^2(θ) - a^2= a^2*(sec^2(θ) - 1) = a^2 * tan^2(θ)
```

#### ◉ 4 配方和三角换元法
在求解关于 ```sqrt(x^2 + a*x + b)``` 的奇次幂的积分，有了一次项 a*x，这样情况很复杂。求解方法：
配方，然后做替代得到以上三种类型之一。

#### ◉ 5 关于三角换元法的总结

| 类型1：sqrt(a^2-x^2)       | 类型2：sqrt(x^2+a^2)    | 类型3：sqrt(x^2-a^2)     |
|:--------------------------|:----------------------:|:-----------------------:|
| 设 x = a * sin(θ)         | 设 x = a*tan(θ)         | 设 x = a * sec(θ)       |
| dx = a * cos(θ) dθ        | dx = a * sec^2(θ) dθ   | dx = a*sec(θ)*tan(θ) dθ |
| a^2-x^2 = a^2 * cos^2(θ)  | x^2+a^2 = a^2 * sec(θ) | x^-a^2 = a^2 * tan^2(θ) |

#### ◉ 6 平方根的方法和三角换元法
1. 类型1：直接把 ```sqrt(a^2 * cos^2(θ))``` 化简为了 a*cos(θ)。实际上，写 x = a*sin(θ)时，是在说 θ = sin -1（x/2）。因为 sin -1 的范围是 [-π/2, π/2]，即 θ 在第一或第四象限，所以 cos(θ) 一直都是非负的（不需要绝对值符号！）
2. 类型2：把 ```sqrt(a^2 * sec^2(θ))``` 化简为 a*sec(θ)。设 θ = tan -1(x/a)，因为 tan -1 值域是 (-π/2, π/2)，所以 θ 也在第一或第四象限，即 sec(θ) 一直都是正的（不需要绝对值符号！）
3. 类型3


## 四、积分技巧综述

* 看到题目时，发现一种显而易见的换元法，那就试试它。如：如果被积函数的一部分是另一部分的导数，那就使用 t 做换元。
* 如果像 sqrt(n)(ax + b)这种形式出现在被积函数中，像在 18.1.2 节中那样设置 ```t = sqrt(n)(ax + b)```
* 对于有理数的积分（一个多项式的商情况），看分子是否为分母导数的倍数。如果是，可以通过设置 t = 分母 来计算。另外也可以使用部分分式法（参照 18.3 节)
* 通过观察后没有发现什么明显的替代方法，可使用这一章介绍过的方法：
    * 关于 ```sqrt(1-cos(x))``` 或 ```sqrt(1+cos(x))``` 的函数：在这种情况下，使用倍角公式；
    * 关于 ```1-sin^2(x)、1-cos^2(x)、1+tan^2(x)、sec^2(x)-1、csc^2(x)-1 或 1+cot^2(x)``` 的函数：在这些情况下，我们需要使用毕达哥拉斯公式：```sin^2(x)+cos^2(x)=1、tan^2(x)+1=sec^2(x) 或 1+cot^2(x)=csc^2(x)```；
    * 关于 1 +- sin(x)（或与其相似的情况）在分母时的函数：在这种情况下，分子分母同时乘以它的共轭表达式，然后尽量使用毕达哥拉斯定理；
    * 关于 ```cos(mx)cos(nx)、sin(mx)sin(nx) 或 sin(mx)cos(nx)``` 的函数的积分：在这种情况下，使用积化和差公式；
    * 三角函数的次幂的积分：你应该学会从 19.2.1 节到 19.2.5 节的所有方法
* 如果被积函数是关于 sqrt(x^2-a^2) 或这种形式的奇次幂的情况（例如 ```(x^2-a^2)^(3/2)``` 或 ```(x^2-a^2)^(5/2)``` 等等），或 sqrt(x^2+a^2) 或 sqrt(a^2-x^2) 或是这两种情况的奇次幂形式，那么使用三角换元法（但要先校验是否有明显的换元）。如果二次函数包含一个一次项，那么先配方(参见 19.3节)。
* 如果被积函数是一个乘积的形式，同时也没有明显的替代可用，那么这时可以考虑分部积分法（参照 18.2节）。
* 如果没有可用的换元法，被积函数又是 ln(x) 的幂的形式或反三角函数的形式，那么可以考虑使用分部积分法。在这种情况下，设 u 是 ln(x) 的形式或为适当的反三角函数。
